
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SQL Joins &#8212; Data Pre-Processing and Visualization OER</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=afe5de03"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Content/Data_Collecting/06_SQL_Joins';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="SQL Wrap Up" href="07_SQL_Wrap.html" />
    <link rel="prev" title="SQL Sub-Queries" href="05_SQL_SubQuery.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../Introduction.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/JuliaSetECUColors.jpg" class="logo__image only-light" alt="Data Pre-Processing and Visualization OER - Home"/>
    <script>document.write(`<img src="../../_static/JuliaSetECUColors.jpg" class="logo__image only-dark" alt="Data Pre-Processing and Visualization OER - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../Introduction.html">
                    Data Pre-Processing and Visualization
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_Python.html">Jupyter Notebooks and Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_Pandas.html">Pandas for Data Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Gathering Data</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="03_SQL.html">Learning Some SQL with BigQuery</a></li>



<li class="toctree-l1 has-children"><a class="reference internal" href="08_html.html">Reading Data From the Web</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="09_html_tables.html">HTML Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_html_selenium.html">Webpage Loading and Scrapping</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="11_Twitter.html">Twitter a Social Media Scrape</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_GatheringConclusion.html">Gathering Data Conclusion</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Cleaning Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Data_Cleaning/13_Data_Types.html">Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Data_Cleaning/14_Strings.html">Strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Data_Cleaning/15_String_Cleaning.html">Strings And Cleaning a DataFrame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Data_Cleaning/16_Dates.html">Dates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Data_Cleaning/17_Ints_and_Floats.html">Integers and Floats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Data_Cleaning/18_One_Hot_Encoding.html">Factors and One Hot Encoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Data_Cleaning/19_Missing_and_Incomplete.html">Missing and Incomplete</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Data_Cleaning/20_Cleaning_Conclusion.html">Exam 2 Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Great Visualizations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Data_Visualization/21_Graphical_Excellence.html">Graphical Excellence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Data_Visualization/22_Graphical_Integrity.html">Graphical Integrity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Data_Visualization/23_Graphical_Sophistication.html">Graphical Sophistication</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Creating Visulaizations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Data_Visualization/24_Amounts.html">Visualize Amounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Data_Visualization/25_Histograms.html">Histograms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Data_Visualization/26_Many_Distributions.html">Many Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Data_Visualization/27_Proportions.html">Proportions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Data_Visualization/28_Associations.html">Visualizing Association</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Data_Visualization/29_Uncertainty.html">Uncertainty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Data_Visualization/30_Visualize_Conclusion.html">Visualization Conclusion</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Project Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Project_Examples/RecentVisualizations.html">Inverted Yield Curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Project_Examples/RecreatingMasters.html">NHL Data Visualization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Selected Solutions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Solutions/mySolutions.html">My Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solutions/Exam1Solutions.html">Exam 1 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solutions/Exam2Solutions.html">Exam 2 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solutions/Exam3Solutions.html">Exam 3 Solutions Data Visualization and Preprocessing</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/nurfnick/Data_Viz/blob/master/Content/Data_Collecting/06_SQL_Joins.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/nurfnick/Data_Viz" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/nurfnick/Data_Viz/issues/new?title=Issue%20on%20page%20%2FContent/Data_Collecting/06_SQL_Joins.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Content/Data_Collecting/06_SQL_Joins.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>SQL Joins</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inner-joins">Inner Joins</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outer-joins">Outer Joins</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#joining-other-tables">Joining Other Tables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#your-turn">Your Turn</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a href="https://colab.research.google.com/github/nurfnick/Data_Viz/blob/main/Content/Data_Collecting/06_SQL_Joins.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="sql-joins">
<h1>SQL Joins<a class="headerlink" href="#sql-joins" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">auth</span>
<span class="n">auth</span><span class="o">.</span><span class="n">authenticate_user</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Authenticated&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Authenticated
</pre></div>
</div>
</div>
</div>
<p>Next we will try to tackle <code class="docutils literal notranslate"><span class="pre">JOINS</span></code>.  There are many ways to join tables in SQL.</p>
<section id="inner-joins">
<h2>Inner Joins<a class="headerlink" href="#inner-joins" title="Link to this heading">#</a></h2>
<p>The easiest way is a cross join.  Essentially this is a cartesian product of the two datasets.  It will create a very large dataset as it is multiplicative in the number of rows.  Here is a small table to start (10 rows)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">bigquery</span> <span class="o">--</span><span class="n">project</span> <span class="n">pic</span><span class="o">-</span><span class="n">math</span>

<span class="n">SELECT</span> <span class="o">*</span>
<span class="n">FROM</span> <span class="err">`</span><span class="n">bigquery</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">iowa_liquor_sales</span><span class="o">.</span><span class="n">sales</span><span class="err">`</span>
<span class="n">WHERE</span> <span class="n">category_name</span> <span class="o">=</span> <span class="s1">&#39;Imported Whiskies&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-ca9e9203-178c-49b7-8640-101404b14b29">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>invoice_and_item_number</th>
      <th>date</th>
      <th>store_number</th>
      <th>store_name</th>
      <th>address</th>
      <th>city</th>
      <th>zip_code</th>
      <th>store_location</th>
      <th>county_number</th>
      <th>county</th>
      <th>category</th>
      <th>category_name</th>
      <th>vendor_number</th>
      <th>vendor_name</th>
      <th>item_number</th>
      <th>item_description</th>
      <th>pack</th>
      <th>bottle_volume_ml</th>
      <th>state_bottle_cost</th>
      <th>state_bottle_retail</th>
      <th>bottles_sold</th>
      <th>sale_dollars</th>
      <th>volume_sold_liters</th>
      <th>volume_sold_gallons</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>INV-34280100007</td>
      <td>2021-02-15</td>
      <td>2190</td>
      <td>Central City Liquor, Inc.</td>
      <td>1460 2ND AVE</td>
      <td>Des Moines</td>
      <td>50314.0</td>
      <td>POINT (-93.619787 41.60566)</td>
      <td>77</td>
      <td>POLK</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987952</td>
      <td>Kavalan Concertmaster</td>
      <td>6</td>
      <td>750</td>
      <td>51.00</td>
      <td>76.50</td>
      <td>6</td>
      <td>459.00</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>1</th>
      <td>INV-34357200008</td>
      <td>2021-02-16</td>
      <td>6035</td>
      <td>Bootlegging Barzinis</td>
      <td>412 First Ave</td>
      <td>Coralville</td>
      <td>52241.0</td>
      <td>POINT (-91.565517 41.672672)</td>
      <td>52</td>
      <td>JOHNSON</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987955</td>
      <td>Kavalan King Car Conductor</td>
      <td>6</td>
      <td>750</td>
      <td>61.34</td>
      <td>92.01</td>
      <td>6</td>
      <td>552.06</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>2</th>
      <td>INV-34280100006</td>
      <td>2021-02-15</td>
      <td>2190</td>
      <td>Central City Liquor, Inc.</td>
      <td>1460 2ND AVE</td>
      <td>Des Moines</td>
      <td>50314.0</td>
      <td>POINT (-93.619787 41.60566)</td>
      <td>77</td>
      <td>POLK</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987951</td>
      <td>Kavalan Classic Single Malt Whiskey</td>
      <td>6</td>
      <td>750</td>
      <td>46.00</td>
      <td>69.00</td>
      <td>6</td>
      <td>414.00</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>3</th>
      <td>INV-41510000010</td>
      <td>2021-11-01</td>
      <td>2190</td>
      <td>Central City Liquor, Inc.</td>
      <td>1460 2ND AVE</td>
      <td>Des Moines</td>
      <td>50314.0</td>
      <td>POINT (-93.619787 41.60566)</td>
      <td>77</td>
      <td>POLK</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987952</td>
      <td>Kavalan Concertmaster</td>
      <td>6</td>
      <td>750</td>
      <td>51.00</td>
      <td>76.50</td>
      <td>6</td>
      <td>459.00</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>4</th>
      <td>INV-34280100008</td>
      <td>2021-02-15</td>
      <td>2190</td>
      <td>Central City Liquor, Inc.</td>
      <td>1460 2ND AVE</td>
      <td>Des Moines</td>
      <td>50314.0</td>
      <td>POINT (-93.619787 41.60566)</td>
      <td>77</td>
      <td>POLK</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987955</td>
      <td>Kavalan King Car Conductor</td>
      <td>6</td>
      <td>750</td>
      <td>61.34</td>
      <td>92.01</td>
      <td>6</td>
      <td>552.06</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>5</th>
      <td>INV-37854400006</td>
      <td>2021-06-28</td>
      <td>2190</td>
      <td>Central City Liquor, Inc.</td>
      <td>1460 2ND AVE</td>
      <td>Des Moines</td>
      <td>50314.0</td>
      <td>POINT (-93.619787 41.60566)</td>
      <td>77</td>
      <td>POLK</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391</td>
      <td>HOTALING &amp; CO</td>
      <td>987952</td>
      <td>Kavalan Concertmaster</td>
      <td>6</td>
      <td>750</td>
      <td>51.00</td>
      <td>76.50</td>
      <td>6</td>
      <td>459.00</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>6</th>
      <td>INV-34357200006</td>
      <td>2021-02-16</td>
      <td>6035</td>
      <td>Bootlegging Barzinis</td>
      <td>412 First Ave</td>
      <td>Coralville</td>
      <td>52241.0</td>
      <td>POINT (-91.565517 41.672672)</td>
      <td>52</td>
      <td>JOHNSON</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987951</td>
      <td>Kavalan Classic Single Malt Whiskey</td>
      <td>6</td>
      <td>750</td>
      <td>46.00</td>
      <td>69.00</td>
      <td>6</td>
      <td>414.00</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>7</th>
      <td>INV-40733900005</td>
      <td>2021-10-06</td>
      <td>3773</td>
      <td>Benz Distributing</td>
      <td>501 7th Ave SE</td>
      <td>Cedar Rapids</td>
      <td>52401.0</td>
      <td>POINT (-91.659875 41.97574)</td>
      <td>57</td>
      <td>LINN</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987953</td>
      <td>Kavalan Ex-Bourbon</td>
      <td>6</td>
      <td>750</td>
      <td>81.84</td>
      <td>122.76</td>
      <td>6</td>
      <td>736.56</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>8</th>
      <td>INV-34357200007</td>
      <td>2021-02-16</td>
      <td>6035</td>
      <td>Bootlegging Barzinis</td>
      <td>412 First Ave</td>
      <td>Coralville</td>
      <td>52241.0</td>
      <td>POINT (-91.565517 41.672672)</td>
      <td>52</td>
      <td>JOHNSON</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987953</td>
      <td>Kavalan Ex-Bourbon</td>
      <td>6</td>
      <td>750</td>
      <td>81.84</td>
      <td>122.76</td>
      <td>6</td>
      <td>736.56</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>9</th>
      <td>INV-40505700006</td>
      <td>2021-09-29</td>
      <td>6035</td>
      <td>Bootlegging Barzinis</td>
      <td>412 First Ave</td>
      <td>Coralville</td>
      <td>52241.0</td>
      <td>POINT (-91.565517 41.672672)</td>
      <td>52</td>
      <td>JOHNSON</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391</td>
      <td>HOTALING &amp; CO</td>
      <td>987953</td>
      <td>Kavalan Ex-Bourbon</td>
      <td>6</td>
      <td>750</td>
      <td>81.84</td>
      <td>122.76</td>
      <td>6</td>
      <td>736.56</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ca9e9203-178c-49b7-8640-101404b14b29')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ca9e9203-178c-49b7-8640-101404b14b29 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ca9e9203-178c-49b7-8640-101404b14b29');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<p>Now we’ll use that table and add to it every column from the same table with the <code class="docutils literal notranslate"><span class="pre">JOIN</span></code>.  Note that the <code class="docutils literal notranslate"><span class="pre">ON</span></code> clause  is over the <em>category_name</em> and they all have the same category name!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">bigquery</span> <span class="o">--</span><span class="n">project</span> <span class="n">pic</span><span class="o">-</span><span class="n">math</span>
<span class="n">WITH</span> <span class="n">t</span> <span class="k">as</span><span class="p">(</span>
<span class="n">SELECT</span> <span class="o">*</span>
<span class="n">FROM</span> <span class="err">`</span><span class="n">bigquery</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">iowa_liquor_sales</span><span class="o">.</span><span class="n">sales</span><span class="err">`</span>
<span class="n">WHERE</span> <span class="n">category_name</span> <span class="o">=</span> <span class="s1">&#39;Imported Whiskies&#39;</span><span class="p">)</span>

<span class="n">SELECT</span> <span class="o">*</span>
<span class="n">FROM</span> <span class="n">t</span> <span class="k">as</span> <span class="n">table1</span> <span class="n">JOIN</span> <span class="n">t</span> <span class="k">as</span> <span class="n">table2</span> <span class="n">ON</span> <span class="n">table1</span><span class="o">.</span><span class="n">category_name</span> <span class="o">=</span> <span class="n">table2</span><span class="o">.</span><span class="n">category_name</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-30a98d25-ea70-4441-85f5-3b96f1f91365">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>invoice_and_item_number</th>
      <th>date</th>
      <th>store_number</th>
      <th>store_name</th>
      <th>address</th>
      <th>city</th>
      <th>zip_code</th>
      <th>store_location</th>
      <th>county_number</th>
      <th>county</th>
      <th>category</th>
      <th>category_name</th>
      <th>vendor_number</th>
      <th>vendor_name</th>
      <th>item_number</th>
      <th>item_description</th>
      <th>pack</th>
      <th>bottle_volume_ml</th>
      <th>state_bottle_cost</th>
      <th>state_bottle_retail</th>
      <th>bottles_sold</th>
      <th>sale_dollars</th>
      <th>volume_sold_liters</th>
      <th>volume_sold_gallons</th>
      <th>invoice_and_item_number_1</th>
      <th>date_1</th>
      <th>store_number_1</th>
      <th>store_name_1</th>
      <th>address_1</th>
      <th>city_1</th>
      <th>zip_code_1</th>
      <th>store_location_1</th>
      <th>county_number_1</th>
      <th>county_1</th>
      <th>category_1</th>
      <th>category_name_1</th>
      <th>vendor_number_1</th>
      <th>vendor_name_1</th>
      <th>item_number_1</th>
      <th>item_description_1</th>
      <th>pack_1</th>
      <th>bottle_volume_ml_1</th>
      <th>state_bottle_cost_1</th>
      <th>state_bottle_retail_1</th>
      <th>bottles_sold_1</th>
      <th>sale_dollars_1</th>
      <th>volume_sold_liters_1</th>
      <th>volume_sold_gallons_1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>INV-34280100007</td>
      <td>2021-02-15</td>
      <td>2190</td>
      <td>Central City Liquor, Inc.</td>
      <td>1460 2ND AVE</td>
      <td>Des Moines</td>
      <td>50314.0</td>
      <td>POINT (-93.619787 41.60566)</td>
      <td>77</td>
      <td>POLK</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987952</td>
      <td>Kavalan Concertmaster</td>
      <td>6</td>
      <td>750</td>
      <td>51.00</td>
      <td>76.50</td>
      <td>6</td>
      <td>459.00</td>
      <td>4.5</td>
      <td>1.18</td>
      <td>INV-34280100007</td>
      <td>2021-02-15</td>
      <td>2190</td>
      <td>Central City Liquor, Inc.</td>
      <td>1460 2ND AVE</td>
      <td>Des Moines</td>
      <td>50314.0</td>
      <td>POINT (-93.619787 41.60566)</td>
      <td>77</td>
      <td>POLK</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987952</td>
      <td>Kavalan Concertmaster</td>
      <td>6</td>
      <td>750</td>
      <td>51.00</td>
      <td>76.50</td>
      <td>6</td>
      <td>459.00</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>1</th>
      <td>INV-34357200008</td>
      <td>2021-02-16</td>
      <td>6035</td>
      <td>Bootlegging Barzinis</td>
      <td>412 First Ave</td>
      <td>Coralville</td>
      <td>52241.0</td>
      <td>POINT (-91.565517 41.672672)</td>
      <td>52</td>
      <td>JOHNSON</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987955</td>
      <td>Kavalan King Car Conductor</td>
      <td>6</td>
      <td>750</td>
      <td>61.34</td>
      <td>92.01</td>
      <td>6</td>
      <td>552.06</td>
      <td>4.5</td>
      <td>1.18</td>
      <td>INV-34280100007</td>
      <td>2021-02-15</td>
      <td>2190</td>
      <td>Central City Liquor, Inc.</td>
      <td>1460 2ND AVE</td>
      <td>Des Moines</td>
      <td>50314.0</td>
      <td>POINT (-93.619787 41.60566)</td>
      <td>77</td>
      <td>POLK</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987952</td>
      <td>Kavalan Concertmaster</td>
      <td>6</td>
      <td>750</td>
      <td>51.00</td>
      <td>76.50</td>
      <td>6</td>
      <td>459.00</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>2</th>
      <td>INV-34280100006</td>
      <td>2021-02-15</td>
      <td>2190</td>
      <td>Central City Liquor, Inc.</td>
      <td>1460 2ND AVE</td>
      <td>Des Moines</td>
      <td>50314.0</td>
      <td>POINT (-93.619787 41.60566)</td>
      <td>77</td>
      <td>POLK</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987951</td>
      <td>Kavalan Classic Single Malt Whiskey</td>
      <td>6</td>
      <td>750</td>
      <td>46.00</td>
      <td>69.00</td>
      <td>6</td>
      <td>414.00</td>
      <td>4.5</td>
      <td>1.18</td>
      <td>INV-34280100007</td>
      <td>2021-02-15</td>
      <td>2190</td>
      <td>Central City Liquor, Inc.</td>
      <td>1460 2ND AVE</td>
      <td>Des Moines</td>
      <td>50314.0</td>
      <td>POINT (-93.619787 41.60566)</td>
      <td>77</td>
      <td>POLK</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987952</td>
      <td>Kavalan Concertmaster</td>
      <td>6</td>
      <td>750</td>
      <td>51.00</td>
      <td>76.50</td>
      <td>6</td>
      <td>459.00</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>3</th>
      <td>INV-41510000010</td>
      <td>2021-11-01</td>
      <td>2190</td>
      <td>Central City Liquor, Inc.</td>
      <td>1460 2ND AVE</td>
      <td>Des Moines</td>
      <td>50314.0</td>
      <td>POINT (-93.619787 41.60566)</td>
      <td>77</td>
      <td>POLK</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987952</td>
      <td>Kavalan Concertmaster</td>
      <td>6</td>
      <td>750</td>
      <td>51.00</td>
      <td>76.50</td>
      <td>6</td>
      <td>459.00</td>
      <td>4.5</td>
      <td>1.18</td>
      <td>INV-34280100007</td>
      <td>2021-02-15</td>
      <td>2190</td>
      <td>Central City Liquor, Inc.</td>
      <td>1460 2ND AVE</td>
      <td>Des Moines</td>
      <td>50314.0</td>
      <td>POINT (-93.619787 41.60566)</td>
      <td>77</td>
      <td>POLK</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987952</td>
      <td>Kavalan Concertmaster</td>
      <td>6</td>
      <td>750</td>
      <td>51.00</td>
      <td>76.50</td>
      <td>6</td>
      <td>459.00</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>4</th>
      <td>INV-34280100008</td>
      <td>2021-02-15</td>
      <td>2190</td>
      <td>Central City Liquor, Inc.</td>
      <td>1460 2ND AVE</td>
      <td>Des Moines</td>
      <td>50314.0</td>
      <td>POINT (-93.619787 41.60566)</td>
      <td>77</td>
      <td>POLK</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987955</td>
      <td>Kavalan King Car Conductor</td>
      <td>6</td>
      <td>750</td>
      <td>61.34</td>
      <td>92.01</td>
      <td>6</td>
      <td>552.06</td>
      <td>4.5</td>
      <td>1.18</td>
      <td>INV-34280100007</td>
      <td>2021-02-15</td>
      <td>2190</td>
      <td>Central City Liquor, Inc.</td>
      <td>1460 2ND AVE</td>
      <td>Des Moines</td>
      <td>50314.0</td>
      <td>POINT (-93.619787 41.60566)</td>
      <td>77</td>
      <td>POLK</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987952</td>
      <td>Kavalan Concertmaster</td>
      <td>6</td>
      <td>750</td>
      <td>51.00</td>
      <td>76.50</td>
      <td>6</td>
      <td>459.00</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>INV-40505700006</td>
      <td>2021-09-29</td>
      <td>6035</td>
      <td>Bootlegging Barzinis</td>
      <td>412 First Ave</td>
      <td>Coralville</td>
      <td>52241.0</td>
      <td>POINT (-91.565517 41.672672)</td>
      <td>52</td>
      <td>JOHNSON</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391</td>
      <td>HOTALING &amp; CO</td>
      <td>987953</td>
      <td>Kavalan Ex-Bourbon</td>
      <td>6</td>
      <td>750</td>
      <td>81.84</td>
      <td>122.76</td>
      <td>6</td>
      <td>736.56</td>
      <td>4.5</td>
      <td>1.18</td>
      <td>INV-34357200007</td>
      <td>2021-02-16</td>
      <td>6035</td>
      <td>Bootlegging Barzinis</td>
      <td>412 First Ave</td>
      <td>Coralville</td>
      <td>52241.0</td>
      <td>POINT (-91.565517 41.672672)</td>
      <td>52</td>
      <td>JOHNSON</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987953</td>
      <td>Kavalan Ex-Bourbon</td>
      <td>6</td>
      <td>750</td>
      <td>81.84</td>
      <td>122.76</td>
      <td>6</td>
      <td>736.56</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>96</th>
      <td>INV-40733900005</td>
      <td>2021-10-06</td>
      <td>3773</td>
      <td>Benz Distributing</td>
      <td>501 7th Ave SE</td>
      <td>Cedar Rapids</td>
      <td>52401.0</td>
      <td>POINT (-91.659875 41.97574)</td>
      <td>57</td>
      <td>LINN</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987953</td>
      <td>Kavalan Ex-Bourbon</td>
      <td>6</td>
      <td>750</td>
      <td>81.84</td>
      <td>122.76</td>
      <td>6</td>
      <td>736.56</td>
      <td>4.5</td>
      <td>1.18</td>
      <td>INV-34357200007</td>
      <td>2021-02-16</td>
      <td>6035</td>
      <td>Bootlegging Barzinis</td>
      <td>412 First Ave</td>
      <td>Coralville</td>
      <td>52241.0</td>
      <td>POINT (-91.565517 41.672672)</td>
      <td>52</td>
      <td>JOHNSON</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987953</td>
      <td>Kavalan Ex-Bourbon</td>
      <td>6</td>
      <td>750</td>
      <td>81.84</td>
      <td>122.76</td>
      <td>6</td>
      <td>736.56</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>97</th>
      <td>INV-34357200007</td>
      <td>2021-02-16</td>
      <td>6035</td>
      <td>Bootlegging Barzinis</td>
      <td>412 First Ave</td>
      <td>Coralville</td>
      <td>52241.0</td>
      <td>POINT (-91.565517 41.672672)</td>
      <td>52</td>
      <td>JOHNSON</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987953</td>
      <td>Kavalan Ex-Bourbon</td>
      <td>6</td>
      <td>750</td>
      <td>81.84</td>
      <td>122.76</td>
      <td>6</td>
      <td>736.56</td>
      <td>4.5</td>
      <td>1.18</td>
      <td>INV-34357200007</td>
      <td>2021-02-16</td>
      <td>6035</td>
      <td>Bootlegging Barzinis</td>
      <td>412 First Ave</td>
      <td>Coralville</td>
      <td>52241.0</td>
      <td>POINT (-91.565517 41.672672)</td>
      <td>52</td>
      <td>JOHNSON</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987953</td>
      <td>Kavalan Ex-Bourbon</td>
      <td>6</td>
      <td>750</td>
      <td>81.84</td>
      <td>122.76</td>
      <td>6</td>
      <td>736.56</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>98</th>
      <td>INV-37854400006</td>
      <td>2021-06-28</td>
      <td>2190</td>
      <td>Central City Liquor, Inc.</td>
      <td>1460 2ND AVE</td>
      <td>Des Moines</td>
      <td>50314.0</td>
      <td>POINT (-93.619787 41.60566)</td>
      <td>77</td>
      <td>POLK</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391</td>
      <td>HOTALING &amp; CO</td>
      <td>987952</td>
      <td>Kavalan Concertmaster</td>
      <td>6</td>
      <td>750</td>
      <td>51.00</td>
      <td>76.50</td>
      <td>6</td>
      <td>459.00</td>
      <td>4.5</td>
      <td>1.18</td>
      <td>INV-34357200007</td>
      <td>2021-02-16</td>
      <td>6035</td>
      <td>Bootlegging Barzinis</td>
      <td>412 First Ave</td>
      <td>Coralville</td>
      <td>52241.0</td>
      <td>POINT (-91.565517 41.672672)</td>
      <td>52</td>
      <td>JOHNSON</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987953</td>
      <td>Kavalan Ex-Bourbon</td>
      <td>6</td>
      <td>750</td>
      <td>81.84</td>
      <td>122.76</td>
      <td>6</td>
      <td>736.56</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>99</th>
      <td>INV-34357200006</td>
      <td>2021-02-16</td>
      <td>6035</td>
      <td>Bootlegging Barzinis</td>
      <td>412 First Ave</td>
      <td>Coralville</td>
      <td>52241.0</td>
      <td>POINT (-91.565517 41.672672)</td>
      <td>52</td>
      <td>JOHNSON</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987951</td>
      <td>Kavalan Classic Single Malt Whiskey</td>
      <td>6</td>
      <td>750</td>
      <td>46.00</td>
      <td>69.00</td>
      <td>6</td>
      <td>414.00</td>
      <td>4.5</td>
      <td>1.18</td>
      <td>INV-34357200007</td>
      <td>2021-02-16</td>
      <td>6035</td>
      <td>Bootlegging Barzinis</td>
      <td>412 First Ave</td>
      <td>Coralville</td>
      <td>52241.0</td>
      <td>POINT (-91.565517 41.672672)</td>
      <td>52</td>
      <td>JOHNSON</td>
      <td>1012000.0</td>
      <td>Imported Whiskies</td>
      <td>391.0</td>
      <td>HOTALING &amp; CO</td>
      <td>987953</td>
      <td>Kavalan Ex-Bourbon</td>
      <td>6</td>
      <td>750</td>
      <td>81.84</td>
      <td>122.76</td>
      <td>6</td>
      <td>736.56</td>
      <td>4.5</td>
      <td>1.18</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 48 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-30a98d25-ea70-4441-85f5-3b96f1f91365')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-30a98d25-ea70-4441-85f5-3b96f1f91365 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-30a98d25-ea70-4441-85f5-3b96f1f91365');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<p>So why would we want to do this?  Well now we could compare each bottle to every other bottle.  We could ask how many bottles cost more than this one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">bigquery</span> <span class="o">--</span><span class="n">project</span> <span class="n">pic</span><span class="o">-</span><span class="n">math</span>
<span class="n">WITH</span> <span class="n">t</span> <span class="k">as</span><span class="p">(</span>
<span class="n">SELECT</span> <span class="o">*</span>
<span class="n">FROM</span> <span class="err">`</span><span class="n">bigquery</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">iowa_liquor_sales</span><span class="o">.</span><span class="n">sales</span><span class="err">`</span>
<span class="n">WHERE</span> <span class="n">category_name</span> <span class="o">=</span> <span class="s1">&#39;Imported Whiskies&#39;</span><span class="p">)</span>

<span class="n">SELECT</span> <span class="n">table1</span><span class="o">.</span><span class="n">item_description</span><span class="p">,</span> <span class="n">SUM</span><span class="p">(</span><span class="n">CASE</span> <span class="n">WHEN</span> <span class="n">table1</span><span class="o">.</span><span class="n">state_bottle_retail</span> <span class="o">&lt;</span> <span class="n">table2</span><span class="o">.</span><span class="n">state_bottle_retail</span> <span class="n">THEN</span> <span class="mi">1</span> <span class="n">ELSE</span> <span class="mi">0</span> <span class="n">END</span><span class="p">)</span> <span class="k">as</span> <span class="n">number_more_expensive</span>
<span class="n">FROM</span> <span class="n">t</span> <span class="k">as</span> <span class="n">table1</span> <span class="n">JOIN</span> <span class="n">t</span> <span class="k">as</span> <span class="n">table2</span> <span class="n">ON</span> <span class="n">table1</span><span class="o">.</span><span class="n">category_name</span> <span class="o">=</span> <span class="n">table2</span><span class="o">.</span><span class="n">category_name</span>
<span class="n">GROUP</span> <span class="n">BY</span> <span class="n">table1</span><span class="o">.</span><span class="n">item_description</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-65f2d1a5-41bc-4adf-8380-a28982fae95b">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>item_description</th>
      <th>number_more_expensive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kavalan Concertmaster</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Kavalan Classic Single Malt Whiskey</td>
      <td>16</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Kavalan King Car Conductor</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kavalan Ex-Bourbon</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-65f2d1a5-41bc-4adf-8380-a28982fae95b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-65f2d1a5-41bc-4adf-8380-a28982fae95b button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-65f2d1a5-41bc-4adf-8380-a28982fae95b');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<p>Wait, I thought I only had 10 bottles?  What we see here is that I had really only 4 bottles.  Let’s fix this!  In the first table, I am including much more than I need and I should just group them by item_description there too</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">bigquery</span> <span class="o">--</span><span class="n">project</span> <span class="n">pic</span><span class="o">-</span><span class="n">math</span>

<span class="n">SELECT</span> <span class="n">item_description</span><span class="p">,</span> <span class="n">MAX</span><span class="p">(</span><span class="n">state_bottle_retail</span><span class="p">)</span> <span class="k">as</span> <span class="n">state_bottle_retail</span><span class="p">,</span> <span class="n">category_name</span>
<span class="n">FROM</span> <span class="err">`</span><span class="n">bigquery</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">iowa_liquor_sales</span><span class="o">.</span><span class="n">sales</span><span class="err">`</span>
<span class="n">WHERE</span> <span class="n">category_name</span> <span class="o">=</span> <span class="s1">&#39;Imported Whiskies&#39;</span>
<span class="n">GROUP</span> <span class="n">BY</span> <span class="n">item_description</span><span class="p">,</span> <span class="n">category_name</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c2ff92c3-9f18-4ce1-b6a1-dcf8c68e8325">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>item_description</th>
      <th>state_bottle_retail</th>
      <th>category_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kavalan Concertmaster</td>
      <td>76.50</td>
      <td>Imported Whiskies</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Kavalan King Car Conductor</td>
      <td>92.01</td>
      <td>Imported Whiskies</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Kavalan Classic Single Malt Whiskey</td>
      <td>69.00</td>
      <td>Imported Whiskies</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kavalan Ex-Bourbon</td>
      <td>122.76</td>
      <td>Imported Whiskies</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c2ff92c3-9f18-4ce1-b6a1-dcf8c68e8325')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-c2ff92c3-9f18-4ce1-b6a1-dcf8c68e8325 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-c2ff92c3-9f18-4ce1-b6a1-dcf8c68e8325');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<p>Now if I get that back into my join, I should get the desired outcome.  You should also ask yourself why category name was kept.  It was needed for the cross join!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">bigquery</span> <span class="o">--</span><span class="n">project</span> <span class="n">pic</span><span class="o">-</span><span class="n">math</span>
<span class="n">WITH</span> <span class="n">t</span> <span class="k">as</span><span class="p">(</span>
<span class="n">SELECT</span> <span class="n">item_description</span><span class="p">,</span> <span class="n">MAX</span><span class="p">(</span><span class="n">state_bottle_retail</span><span class="p">)</span> <span class="k">as</span> <span class="n">state_bottle_retail</span><span class="p">,</span> <span class="n">category_name</span>
<span class="n">FROM</span> <span class="err">`</span><span class="n">bigquery</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">iowa_liquor_sales</span><span class="o">.</span><span class="n">sales</span><span class="err">`</span>
<span class="n">WHERE</span> <span class="n">category_name</span> <span class="o">=</span> <span class="s1">&#39;Imported Whiskies&#39;</span>
<span class="n">GROUP</span> <span class="n">BY</span> <span class="n">item_description</span><span class="p">,</span> <span class="n">category_name</span><span class="p">)</span>

<span class="n">SELECT</span> <span class="n">table1</span><span class="o">.</span><span class="n">item_description</span><span class="p">,</span> <span class="n">SUM</span><span class="p">(</span><span class="n">CASE</span> <span class="n">WHEN</span> <span class="n">table1</span><span class="o">.</span><span class="n">state_bottle_retail</span> <span class="o">&lt;</span> <span class="n">table2</span><span class="o">.</span><span class="n">state_bottle_retail</span> <span class="n">THEN</span> <span class="mi">1</span> <span class="n">ELSE</span> <span class="mi">0</span> <span class="n">END</span><span class="p">)</span> <span class="k">as</span> <span class="n">number_more_expensive</span><span class="p">,</span> <span class="n">table1</span><span class="o">.</span><span class="n">state_bottle_retail</span> <span class="k">as</span> <span class="n">price</span>
<span class="n">FROM</span> <span class="n">t</span> <span class="k">as</span> <span class="n">table1</span> <span class="n">JOIN</span> <span class="n">t</span> <span class="k">as</span> <span class="n">table2</span> <span class="n">ON</span> <span class="n">table1</span><span class="o">.</span><span class="n">category_name</span> <span class="o">=</span> <span class="n">table2</span><span class="o">.</span><span class="n">category_name</span>
<span class="n">GROUP</span> <span class="n">BY</span> <span class="n">table1</span><span class="o">.</span><span class="n">item_description</span><span class="p">,</span> <span class="n">table1</span><span class="o">.</span><span class="n">state_bottle_retail</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-d2984090-c2c7-40dc-8ba7-743f91377e0c">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>item_description</th>
      <th>number_more_expensive</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kavalan Concertmaster</td>
      <td>2</td>
      <td>76.50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Kavalan King Car Conductor</td>
      <td>1</td>
      <td>92.01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Kavalan Classic Single Malt Whiskey</td>
      <td>3</td>
      <td>69.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kavalan Ex-Bourbon</td>
      <td>0</td>
      <td>122.76</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d2984090-c2c7-40dc-8ba7-743f91377e0c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-d2984090-c2c7-40dc-8ba7-743f91377e0c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-d2984090-c2c7-40dc-8ba7-743f91377e0c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<p>A word of note here!  The inner join preformed here will only join two datasets <strong>if</strong> the <code class="docutils literal notranslate"><span class="pre">ON</span></code> matches.  When it does not, the row will not be included in the join.  Let’s see that in action!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">bigquery</span> <span class="o">--</span><span class="n">project</span> <span class="n">pic</span><span class="o">-</span><span class="n">math</span>

<span class="n">WITH</span> <span class="n">iw</span> <span class="k">as</span><span class="p">(</span>
<span class="n">SELECT</span> <span class="n">item_description</span><span class="p">,</span> <span class="n">MAX</span><span class="p">(</span><span class="n">state_bottle_retail</span><span class="p">)</span> <span class="k">as</span> <span class="n">state_bottle_retail</span><span class="p">,</span> <span class="n">category_name</span>
<span class="n">FROM</span> <span class="err">`</span><span class="n">bigquery</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">iowa_liquor_sales</span><span class="o">.</span><span class="n">sales</span><span class="err">`</span>
<span class="n">WHERE</span> <span class="n">category_name</span> <span class="o">=</span> <span class="s1">&#39;Imported Whiskies&#39;</span>
<span class="n">GROUP</span> <span class="n">BY</span> <span class="n">item_description</span><span class="p">,</span> <span class="n">category_name</span><span class="p">)</span>


<span class="n">SELECT</span> <span class="o">*</span>
<span class="n">FROM</span> <span class="n">iw</span> <span class="n">JOIN</span> 
      <span class="p">(</span><span class="n">SELECT</span> <span class="n">item_description</span><span class="p">,</span> <span class="n">MAX</span><span class="p">(</span><span class="n">state_bottle_retail</span><span class="p">)</span> <span class="k">as</span> <span class="n">state_bottle_retail</span><span class="p">,</span> <span class="n">category_name</span>
      <span class="n">FROM</span> <span class="err">`</span><span class="n">bigquery</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">iowa_liquor_sales</span><span class="o">.</span><span class="n">sales</span><span class="err">`</span>
      <span class="n">WHERE</span> <span class="n">category_name</span> <span class="o">=</span> <span class="s1">&#39;Coffee Liqueurs&#39;</span>
      <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">item_description</span><span class="p">,</span> <span class="n">category_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">cl</span>
      <span class="n">ON</span> <span class="n">iw</span><span class="o">.</span><span class="n">category_name</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">category_name</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-ce627bfd-655f-4477-8de6-f331a5d63def">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>item_description</th>
      <th>state_bottle_retail</th>
      <th>category_name</th>
      <th>item_description_1</th>
      <th>state_bottle_retail_1</th>
      <th>category_name_1</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ce627bfd-655f-4477-8de6-f331a5d63def')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ce627bfd-655f-4477-8de6-f331a5d63def button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ce627bfd-655f-4477-8de6-f331a5d63def');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<p>Nothing was printed because nothing will match!  All the data was lost!  Now this example seems a little far fetched but often your tables may have missing or omitted data.  It doesn’t mean that row should be lost because the column you were working with didn’t have a match!  We examine this in the next section.</p>
</section>
<section id="outer-joins">
<h2>Outer Joins<a class="headerlink" href="#outer-joins" title="Link to this heading">#</a></h2>
<p>Let’s take the last example and do a <code class="docutils literal notranslate"><span class="pre">LEFT</span> <span class="pre">OUTER</span> <span class="pre">JOIN</span></code> this will force the left table (<em>Imported Whiskies</em>) to be included in the table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">bigquery</span> <span class="o">--</span><span class="n">project</span> <span class="n">pic</span><span class="o">-</span><span class="n">math</span>

<span class="n">WITH</span> <span class="n">iw</span> <span class="k">as</span><span class="p">(</span>
<span class="n">SELECT</span> <span class="n">item_description</span><span class="p">,</span> <span class="n">MAX</span><span class="p">(</span><span class="n">state_bottle_retail</span><span class="p">)</span> <span class="k">as</span> <span class="n">state_bottle_retail</span><span class="p">,</span> <span class="n">category_name</span>
<span class="n">FROM</span> <span class="err">`</span><span class="n">bigquery</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">iowa_liquor_sales</span><span class="o">.</span><span class="n">sales</span><span class="err">`</span>
<span class="n">WHERE</span> <span class="n">category_name</span> <span class="o">=</span> <span class="s1">&#39;Imported Whiskies&#39;</span>
<span class="n">GROUP</span> <span class="n">BY</span> <span class="n">item_description</span><span class="p">,</span> <span class="n">category_name</span><span class="p">)</span>


<span class="n">SELECT</span> <span class="o">*</span>
<span class="n">FROM</span> <span class="n">iw</span> <span class="n">LEFT</span> <span class="n">OUTER</span> <span class="n">JOIN</span> 
      <span class="p">(</span><span class="n">SELECT</span> <span class="n">item_description</span><span class="p">,</span> <span class="n">MAX</span><span class="p">(</span><span class="n">state_bottle_retail</span><span class="p">)</span> <span class="k">as</span> <span class="n">state_bottle_retail</span><span class="p">,</span> <span class="n">category_name</span>
      <span class="n">FROM</span> <span class="err">`</span><span class="n">bigquery</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">iowa_liquor_sales</span><span class="o">.</span><span class="n">sales</span><span class="err">`</span>
      <span class="n">WHERE</span> <span class="n">category_name</span> <span class="o">=</span> <span class="s1">&#39;Coffee Liqueurs&#39;</span>
      <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">item_description</span><span class="p">,</span> <span class="n">category_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">cl</span>
      <span class="n">ON</span> <span class="n">iw</span><span class="o">.</span><span class="n">category_name</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">category_name</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c7bc2a21-8802-491f-b7da-2f982e6b3585">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>item_description</th>
      <th>state_bottle_retail</th>
      <th>category_name</th>
      <th>item_description_1</th>
      <th>state_bottle_retail_1</th>
      <th>category_name_1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kavalan Concertmaster</td>
      <td>76.50</td>
      <td>Imported Whiskies</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Kavalan Classic Single Malt Whiskey</td>
      <td>69.00</td>
      <td>Imported Whiskies</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Kavalan King Car Conductor</td>
      <td>92.01</td>
      <td>Imported Whiskies</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kavalan Ex-Bourbon</td>
      <td>122.76</td>
      <td>Imported Whiskies</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c7bc2a21-8802-491f-b7da-2f982e6b3585')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-c7bc2a21-8802-491f-b7da-2f982e6b3585 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-c7bc2a21-8802-491f-b7da-2f982e6b3585');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<p>The Whiskies appear even though they never matched the coffee Liqueurs!</p>
<p>Can you guess what <code class="docutils literal notranslate"><span class="pre">RIGHT</span> <span class="pre">OUTER</span> <span class="pre">JOIN</span></code> will do?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">bigquery</span> <span class="o">--</span><span class="n">project</span> <span class="n">pic</span><span class="o">-</span><span class="n">math</span>

<span class="n">WITH</span> <span class="n">iw</span> <span class="k">as</span><span class="p">(</span>
<span class="n">SELECT</span> <span class="n">item_description</span><span class="p">,</span> <span class="n">MAX</span><span class="p">(</span><span class="n">state_bottle_retail</span><span class="p">)</span> <span class="k">as</span> <span class="n">state_bottle_retail</span><span class="p">,</span> <span class="n">category_name</span>
<span class="n">FROM</span> <span class="err">`</span><span class="n">bigquery</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">iowa_liquor_sales</span><span class="o">.</span><span class="n">sales</span><span class="err">`</span>
<span class="n">WHERE</span> <span class="n">category_name</span> <span class="o">=</span> <span class="s1">&#39;Imported Whiskies&#39;</span>
<span class="n">GROUP</span> <span class="n">BY</span> <span class="n">item_description</span><span class="p">,</span> <span class="n">category_name</span><span class="p">)</span>


<span class="n">SELECT</span> <span class="o">*</span>
<span class="n">FROM</span> <span class="n">iw</span> <span class="n">RIGHT</span> <span class="n">OUTER</span> <span class="n">JOIN</span>
      <span class="p">(</span><span class="n">SELECT</span> <span class="n">item_description</span><span class="p">,</span> <span class="n">MAX</span><span class="p">(</span><span class="n">state_bottle_retail</span><span class="p">)</span> <span class="k">as</span> <span class="n">state_bottle_retail</span><span class="p">,</span> <span class="n">category_name</span>
      <span class="n">FROM</span> <span class="err">`</span><span class="n">bigquery</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">iowa_liquor_sales</span><span class="o">.</span><span class="n">sales</span><span class="err">`</span>
      <span class="n">WHERE</span> <span class="n">category_name</span> <span class="o">=</span> <span class="s1">&#39;Coffee Liqueurs&#39;</span>
      <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">item_description</span><span class="p">,</span> <span class="n">category_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">cl</span>
      <span class="n">ON</span> <span class="n">iw</span><span class="o">.</span><span class="n">category_name</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">category_name</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-82fbbf85-33ce-4f2c-84ec-53e5a3879e7c">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>item_description</th>
      <th>state_bottle_retail</th>
      <th>category_name</th>
      <th>item_description_1</th>
      <th>state_bottle_retail_1</th>
      <th>category_name_1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Kahlua Coffee</td>
      <td>39.72</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>1</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Kahlua Coffee Mini</td>
      <td>9.90</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>2</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Kamora Coffee Liqueur</td>
      <td>18.09</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>3</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Kahlua Coffee Liqueur</td>
      <td>37.49</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>4</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Kahlua Salted Caramel</td>
      <td>19.49</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>5</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Kapali Coffee Liqueur</td>
      <td>8.58</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>6</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>CCD Coffee Liqueur</td>
      <td>24.00</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>7</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Iowa Coffee Company Liqueur</td>
      <td>13.50</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>8</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Patron Xo Cafe</td>
      <td>21.75</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>9</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Kahlua Vanilla</td>
      <td>19.49</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>10</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Kahlua Coffee Liqueur Mini</td>
      <td>9.90</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>11</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Caffe Lolita Coffee Liqueur</td>
      <td>7.50</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>12</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Kahlua French Vanilla Liqueur DISCO</td>
      <td>18.74</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>13</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Chila Coffee Liqueur</td>
      <td>7.46</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>14</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Copa De Oro Mexican Coffee</td>
      <td>8.81</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>15</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Kahlua Especial</td>
      <td>17.99</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>16</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Patron XO Cafe</td>
      <td>21.00</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>17</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Tia Maria Coffee Liqueur</td>
      <td>23.00</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>18</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Carolans Cold Brew</td>
      <td>14.25</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>19</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>J. Rieger &amp; Co. Caffe Amaro</td>
      <td>23.25</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>20</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Mozart Chocolate Coffee Cream Liqueur</td>
      <td>22.31</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>21</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Grind Espresso Shot</td>
      <td>13.50</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>22</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Original Secret Family Recipe - A Coffee Liqueur</td>
      <td>27.00</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>23</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Kahlua French Vanilla Liqueur</td>
      <td>17.99</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>24</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Dr McGillicuddys Coffee</td>
      <td>12.99</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>25</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Kahlua Peppermint Mocha</td>
      <td>17.99</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>26</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Kahlua Chili Chocolate</td>
      <td>17.99</td>
      <td>Coffee Liqueurs</td>
    </tr>
    <tr>
      <th>27</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Conciere Coffee Liqueur</td>
      <td>4.49</td>
      <td>Coffee Liqueurs</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-82fbbf85-33ce-4f2c-84ec-53e5a3879e7c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-82fbbf85-33ce-4f2c-84ec-53e5a3879e7c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-82fbbf85-33ce-4f2c-84ec-53e5a3879e7c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<p>We guarantee all the right table’s entries are included!</p>
</section>
<section id="joining-other-tables">
<h2>Joining Other Tables<a class="headerlink" href="#joining-other-tables" title="Link to this heading">#</a></h2>
<p>Up to now, I have just been joining the same table together.  What is really great about a relational database is the relations!  Let’s try to get information from another table into ours!  I am wondering if some counties drink more liquor than others.  Well of course more populous counties will so let’s see if we can get the population added by zipcode.  I’ll pull data from the 2010 census.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">bigquery</span> <span class="o">--</span><span class="n">project</span> <span class="n">pic</span><span class="o">-</span><span class="n">math</span>

<span class="n">SELECT</span> <span class="o">*</span>
<span class="n">FROM</span> <span class="err">`</span><span class="n">bigquery</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">census_bureau_usa</span><span class="o">.</span><span class="n">population_by_zip_2010</span><span class="err">`</span>
<span class="n">LIMIT</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-7f133a20-91a3-4211-abe8-8755fcf5e274">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geo_id</th>
      <th>zipcode</th>
      <th>population</th>
      <th>minimum_age</th>
      <th>maximum_age</th>
      <th>gender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8600000US00601</td>
      <td>601</td>
      <td>18570</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8600000US00602</td>
      <td>602</td>
      <td>41520</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8600000US00603</td>
      <td>603</td>
      <td>54689</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8600000US00606</td>
      <td>606</td>
      <td>6615</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8600000US00610</td>
      <td>610</td>
      <td>29016</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>5</th>
      <td>8600000US00612</td>
      <td>612</td>
      <td>67010</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8600000US00616</td>
      <td>616</td>
      <td>11017</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8600000US00617</td>
      <td>617</td>
      <td>24597</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8600000US00622</td>
      <td>622</td>
      <td>7853</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>9</th>
      <td>8600000US00623</td>
      <td>623</td>
      <td>43061</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7f133a20-91a3-4211-abe8-8755fcf5e274')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-7f133a20-91a3-4211-abe8-8755fcf5e274 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-7f133a20-91a3-4211-abe8-8755fcf5e274');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<p>So I want to add population to a row but keep any sales even if the population does not work.  You should note that the census breaks down population by age and gender.  I just want the total and that happens when those three categories are <code class="docutils literal notranslate"><span class="pre">NULL</span></code> so I ask that.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">bigquery</span> <span class="o">--</span><span class="n">project</span> <span class="n">pic</span><span class="o">-</span><span class="n">math</span>

<span class="n">SELECT</span> <span class="n">liquor</span><span class="o">.</span><span class="n">city</span><span class="p">,</span><span class="n">liquor</span><span class="o">.</span><span class="n">zip_code</span><span class="p">,</span><span class="n">liquor</span><span class="o">.</span><span class="n">category_name</span><span class="p">,</span><span class="n">liquor</span><span class="o">.</span><span class="n">bottles_sold</span><span class="p">,</span><span class="nb">zip</span><span class="o">.</span><span class="n">population</span>
<span class="n">FROM</span> <span class="err">`</span><span class="n">bigquery</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">iowa_liquor_sales</span><span class="o">.</span><span class="n">sales</span><span class="err">`</span> <span class="k">as</span> <span class="n">liquor</span> <span class="n">LEFT</span> <span class="n">OUTER</span> <span class="n">JOIN</span> <span class="err">`</span><span class="n">bigquery</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">census_bureau_usa</span><span class="o">.</span><span class="n">population_by_zip_2010</span><span class="err">`</span> <span class="k">as</span> <span class="nb">zip</span> 
      <span class="n">ON</span> <span class="n">liquor</span><span class="o">.</span><span class="n">zip_code</span> <span class="o">=</span> <span class="nb">zip</span><span class="o">.</span><span class="n">zipcode</span>
<span class="n">WHERE</span> <span class="nb">zip</span><span class="o">.</span><span class="n">gender</span> <span class="n">IS</span> <span class="n">NULL</span> <span class="n">AND</span> <span class="nb">zip</span><span class="o">.</span><span class="n">minimum_age</span> <span class="n">IS</span> <span class="n">NULL</span> <span class="n">AND</span> <span class="nb">zip</span><span class="o">.</span><span class="n">maximum_age</span> <span class="n">IS</span> <span class="n">NULL</span>
<span class="n">LIMIT</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-78e4d865-d6f5-4b92-8e45-b3b7db70ca39">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>zip_code</th>
      <th>category_name</th>
      <th>bottles_sold</th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cedar Rapids</td>
      <td>52401.0</td>
      <td>Imported Distilled Spirit Specialty</td>
      <td>72</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>LEON</td>
      <td>50144</td>
      <td>WATERMELON SCHNAPPS</td>
      <td>4</td>
      <td>2901.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CEDAR RAPIDS</td>
      <td>52401</td>
      <td>DISTILLED SPIRITS SPECIALTY</td>
      <td>48</td>
      <td>2017.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>KEOKUK</td>
      <td>52632</td>
      <td>ROOT BEER SCHNAPPS</td>
      <td>48</td>
      <td>13086.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>COUNCIL BLUFFS</td>
      <td>51503</td>
      <td>PEACH SCHNAPPS</td>
      <td>7</td>
      <td>36376.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Des Moines</td>
      <td>50314.0</td>
      <td>Triple Sec</td>
      <td>180</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Johnston</td>
      <td>50131.0</td>
      <td>Neutral Grain Spirits Flavored</td>
      <td>16</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>CEDAR RAPIDS</td>
      <td>52402</td>
      <td>TRIPLE SEC</td>
      <td>240</td>
      <td>40149.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>CEDAR RAPIDS</td>
      <td>52402</td>
      <td>IMPORTED DRY GINS</td>
      <td>72</td>
      <td>40149.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>DAVENPORT</td>
      <td>52802</td>
      <td>100 PROOF VODKA</td>
      <td>60</td>
      <td>10868.0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-78e4d865-d6f5-4b92-8e45-b3b7db70ca39')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-78e4d865-d6f5-4b92-8e45-b3b7db70ca39 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-78e4d865-d6f5-4b92-8e45-b3b7db70ca39');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<p>There are still some issues here!  Newton has a zip code but it is being interpreted as a float then converted to a string.  This would require some data munging that we have yet to discuss!  In any case this gives us a nice table where we could ask more complicated questions!</p>
</section>
<section id="your-turn">
<h2>Your Turn<a class="headerlink" href="#your-turn" title="Link to this heading">#</a></h2>
<p>Examine the average trip on Austin bike share grouping by <em>property_type</em> column from the <em>bikeshare_stations</em> table.  Is average time on trips starting from ‘parkland’ longer than from ‘sidewalks’?  To answer this question you must join the <em>bikeshare_trips</em> and <em>bikeshare_stations</em> on the <em>start_station_name</em> and the <em>name</em> from their respective tables.</p>
<p>The below table is from <em>bikeshare_stations</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">bigquery</span> <span class="o">--</span><span class="n">project</span> <span class="n">pic</span><span class="o">-</span><span class="n">math</span>

<span class="n">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">property_type</span>
<span class="n">FROM</span> <span class="err">`</span><span class="n">bigquery</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">austin_bikeshare</span><span class="o">.</span><span class="n">bikeshare_stations</span><span class="err">`</span>
<span class="n">LIMIT</span> <span class="mi">50</span>

</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-fb20c0cb-b36e-4cd9-8c82-35f9a0e35622">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>property_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Rainey @ River St</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Toomey Rd @ South Lamar</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>East 7th &amp; Pleasant Valley</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Pease Park</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>OFFICE/Main/Shop/Repair</td>
      <td>None</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6th &amp; Navasota St.</td>
      <td>None</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8th &amp; Guadalupe</td>
      <td>None</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Red River &amp; LBJ Library</td>
      <td>None</td>
    </tr>
    <tr>
      <th>8</th>
      <td>State Parking Garage @ Brazos &amp; 18th</td>
      <td>None</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Zilker Park West</td>
      <td>None</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Lavaca &amp; 6th</td>
      <td>None</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Nueces @ 3rd</td>
      <td>None</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Republic Square</td>
      <td>None</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Waller &amp; 6th St.</td>
      <td>None</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Bullock Museum @ Congress &amp; MLK</td>
      <td>None</td>
    </tr>
    <tr>
      <th>15</th>
      <td>State Capitol @ 14th &amp; Colorado</td>
      <td>None</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ACC - Rio Grande &amp; 12th</td>
      <td>None</td>
    </tr>
    <tr>
      <th>17</th>
      <td>ACC - West &amp; 12th Street</td>
      <td>None</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Republic Square @ Guadalupe &amp; 4th St.</td>
      <td>None</td>
    </tr>
    <tr>
      <th>19</th>
      <td>5th &amp; San Marcos</td>
      <td>None</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Barton Springs &amp; Riverside</td>
      <td></td>
    </tr>
    <tr>
      <th>21</th>
      <td>Boardwalk West</td>
      <td>parkland</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Congress &amp; Cesar Chavez</td>
      <td>parkland</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Barton Springs Pool</td>
      <td>parkland</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Riverside @ S. Lamar</td>
      <td>parkland</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Zilker Park</td>
      <td>parkland</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Rainey St @ Cummings</td>
      <td>parkland</td>
    </tr>
    <tr>
      <th>27</th>
      <td>13th &amp; Trinity</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>28</th>
      <td>22nd 1/2 &amp; Rio Grande</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>29</th>
      <td>East 5th/Shady @ Eastside Bus Plaza</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>30</th>
      <td>South Congress &amp; Academy</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>31</th>
      <td>8th &amp; Congress</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Capitol Station / Congress &amp; 11th</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Lavaca &amp; 6th</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>34</th>
      <td>8th &amp; Lavaca</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>35</th>
      <td>South Congress &amp; James</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Barton Springs @ Kinney Ave</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Trinity &amp; 6th Street</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>38</th>
      <td>21st &amp; Speedway @PCL</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>39</th>
      <td>23rd &amp; San Jacinto @ DKR Stadium</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>40</th>
      <td>6th &amp; Congress</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>41</th>
      <td>11th &amp; San Jacinto</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Convention Center / 3rd &amp; Trinity</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Long Center @ South 1st &amp; Riverside</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>44</th>
      <td>State Capitol Visitors Garage @ San Jacinto &amp; ...</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Lake Austin Blvd @ Deep Eddy</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Plaza Saltillo</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Red River &amp; 8th Street</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Republic Square @ 5th &amp; Guadalupe</td>
      <td>sidewalk</td>
    </tr>
    <tr>
      <th>49</th>
      <td>South Congress &amp; Barton Springs at the Austin ...</td>
      <td>sidewalk</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-fb20c0cb-b36e-4cd9-8c82-35f9a0e35622')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-fb20c0cb-b36e-4cd9-8c82-35f9a0e35622 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-fb20c0cb-b36e-4cd9-8c82-35f9a0e35622');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Content\Data_Collecting"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="05_SQL_SubQuery.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">SQL Sub-Queries</p>
      </div>
    </a>
    <a class="right-next"
       href="07_SQL_Wrap.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">SQL Wrap Up</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inner-joins">Inner Joins</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outer-joins">Outer Joins</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#joining-other-tables">Joining Other Tables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#your-turn">Your Turn</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>